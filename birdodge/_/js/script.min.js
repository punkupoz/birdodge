function Game(e,i,t,n,l,r,a,h,o){this.current=e,this.counter=i,this.fireballspeed=t,this.fireballsInterval=n,this.fireballs=l,this.playerx=r,this.playery=a,this.lives=h,this.level=o}var FIREBALL_INTERVAL,FIREBALL_INTERVAL_MIN,FIREBALL_INTERVAL_REDUCE;window.innerWidth<1e3?(FIREBALL_INTERVAL=1e3,FIREBALL_INTERVAL_MIN=400,FIREBALL_INTERVAL_REDUCE=200):(FIREBALL_INTERVAL=600,FIREBALL_INTERVAL_MIN=100,FIREBALL_INTERVAL_REDUCE=175);var bg=new Image;bg.src="./images/background.png";var fb=new Image;fb.src="./images/fireball.png";var mygame,playing=!1;$(document).bind("pageshow","#home",function(e){var i=new Image;i.src="./images/slime.png",i.onload=function(){function e(){g.width=window.innerWidth,g.height=window.innerHeight}function t(){var e=Math.floor(Math.random()*(g.width-fb.width)),i=-fb.width;S.push({x:e,y:i}),A+=1,A-R==25&&(R=A,_>FIREBALL_INTERVAL_MIN&&(_-=FIREBALL_INTERVAL_REDUCE),B++,N+=2)}function n(){for(var e=0;e<S.length;e++)f.drawImage(fb,S[e].x,S[e].y+=N),S[e].y>g.height&&S.splice(e,1)}function l(e,t){this.x=e,this.y=t,this.vel=0,this.render=function(){f.drawImage(i,this.x,this.y)},this.newPos=function(){this.y+this.vel+i.height>window.innerHeight?(this.vel=0,this.y=g.height-i.height):this.y<0?(this.vel=10,this.y+=this.vel):(this.vel+=x,this.y+=this.vel),this.x+=b+m,p?m>0&&(m+=L):p||0>m&&(m+=L),this.x>window.innerWidth-i.width?this.x=window.innerWidth-i.width:this.x<0&&(this.x=0)}}function r(){for(var e=0;e<S.length;e++)V.x+i.width>S[e].x&&V.x<S[e].x+fb.width&&V.y+i.height>S[e].y&&V.y<S[e].y+fb.height&&(S.splice(e,1),T--)}function a(){f.clearRect(0,0,g.width,g.height),V.render(),V.newPos(),f.drawImage(bg,0,g.height-bg.height,g.width,bg.height),n(),I&&(V.vel=-16,I=!1),r(),f.font="20px serif",f.fillStyle="black",f.fillText("SCORE: "+A,10,20),f.fillStyle="purple",f.fillText("LEVEL: "+B,10,50),f.fillStyle="red",f.fillText("LIVES <3: "+T,10,80),0==T&&(h(),s()),V.y>=window.innerHeight-i.height&&(T=0)}function h(){clearInterval(y),clearInterval(E),f.font="25px serif";var e="YOU ARE TOASTED";f.fillText(e,(window.innerWidth-f.measureText(e).width)/2,.3*window.innerHeight),console.log(f.measureText(e).width),o()}function o(){clearInterval(y),clearInterval(E),v.current=R,v.counter=A,v.fireballspeed=N,v.fireballsInterval=_,v.fireballs=S,v.playerx=V.x,v.playery=V.y,v.lives=T,v.level=B;var e=JSON.stringify(v);localStorage.setItem("game",e)}function s(){$("#replay").attr("src","images/reload.png")}function d(){0!=T&&0!=A&&c.play()}var c=document.createElement("audio");c.setAttribute("src","sounds/swing.mp3");var g=document.getElementById("mCanvas"),f=g.getContext("2d"),w=localStorage.getItem("game");if(null==w)var v=new Game(0,0,5,FIREBALL_INTERVAL,[],(window.innerWidth-i.width)/2,0,5,1);else{var u=JSON.parse(w);if(0!=u.lives)var v=new Game(u.current,u.counter,u.fireballspeed,u.fireballsInterval,u.fireballs,u.playerx,u.playery,u.lives,u.level);else var v=new Game(0,0,5,FIREBALL_INTERVAL,[],(window.innerWidth-i.width)/2,0,5,1)}var p,y,E,I=!1,m=0,L=0,b=0,x=1,R=v.current,A=v.counter,T=v.lives,_=v.fireballsInterval,N=v.fireballspeed,B=v.level;e(),window.DeviceMotionEvent&&window.addEventListener("deviceorientation",function(e){b=e.gamma});var S=v.fireballs,V=new l(v.playerx,v.playery);V.render(),f.drawImage(bg,0,g.height-bg.height,g.width,bg.height),f.font="20px serif",f.fillStyle="black",f.fillText("SCORE: "+A,10,20),f.fillStyle="black";var F="Control this Bird";f.fillText(F,V.x+i.width/2-f.measureText(F).width/2,V.y+i.height+20),f.fillStyle="purple",f.fillText("LEVEL: "+B,10,50),f.fillStyle="red",f.fillText("<3: "+T,10,80),n(),$("#stop").on("click",function(){o(),playing=!1}),$("#replay").on("click",function(){"images/reload.png"==$("#replay").attr("src")?(R=0,A=0,T=5,N=5,_=FIREBALL_INTERVAL,S=[],V.x=(window.innerWidth-i.width)/2,V.y=5,T=5,B=1,$("#replay").attr("src","images/Button-Play-icon.png"),playing=!1,f.clearRect(0,0,g.width,g.height),V.render(),f.drawImage(bg,0,g.height-bg.height,g.width,bg.height),f.font="20px serif",f.fillStyle="black",f.fillText("SCORE: "+A,10,20),f.fillStyle="purple",f.fillText("LEVEL: "+B,10,50),f.fillStyle="red",f.fillText("<3: "+T,10,80),n()):0==playing&&(y=setInterval(a,1e3/35),E=setInterval(t,_),playing=!0)}),console.log(window.DeviceMotionEvent),window.DeviceMotionEvent&&(console.log("window.DeviceMotionEvent"),$("#mCanvas").on("tap",function(){I=!0,d()})),$(document).keydown(function(e){38==e.which&&(I=!0,d()),37==e.which&&(p=!1,L=.2,m>0&&(m=0),m>=-24&&(m-=8)),39==e.which&&(p=!0,L=-.2,0>m&&(m=0),24>=m&&(m+=8))}),$(window).blur(function(e){playing=!1,o()}),$(window).on("beforeunload",function(){playing=!1,o()}),$("#a2").on("click",function(){FB.ui({method:"feed",app_id:"1755374691360566",link:"http://puncel.com/birdodge",name:"LOOK! I just got "+A+" points in Birdodge, try the game now!",caption:"Play the cool game \\m/",picture:"http://puncel.com/birdodge/shareimage.png"},function(e){})})}}),$(document).bind("touchmove.heightmove",function(e){e.preventDefault()});